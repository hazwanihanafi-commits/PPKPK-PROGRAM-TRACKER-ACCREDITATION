<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PPKPK â€“ SRR Main Dashboard</title>

<style>
body {
  font-family: Arial, sans-serif;
  background:#f6f8fb;
  padding:24px;
}

h1 { margin-bottom:20px; }

.grid {
  display:grid;
  grid-template-columns:repeat(auto-fill,minmax(380px,1fr));
  gap:20px;
}

.card {
  background:white;
  border-radius:14px;
  padding:20px;
  box-shadow:0 6px 16px rgba(0,0,0,0.08);
}

.badge {
  display:inline-block;
  padding:6px 14px;
  border-radius:20px;
  font-size:12px;
  margin:8px 0;
}

.ready {
  background:#e6fff0;
  color:#047857;
}

.not-ready {
  background:#fee2e2;
  color:#991b1b;
}

.progress {
  background:#e5e7eb;
  border-radius:20px;
  overflow:hidden;
  height:10px;
  margin:10px 0;
}

.progress div {
  height:100%;
  background:#6366f1;
}

button {
  margin-top:12px;
  padding:8px 12px;
  border-radius:8px;
  border:1px solid #ccc;
  background:#fff;
  cursor:pointer;
}
</style>
</head>

<body>

<h1>ðŸ“˜ PPKPK â€“ SRR Programme Readiness Dashboard</h1>

<div id="programmeGrid" class="grid"></div>

<script>
// ================= CONFIG =================
const APPENDIX_API =
 "https://script.google.com/macros/s/AKfycbzzfNBLau1GPNucFLHvLUc_78B5M21SbE2AYYzbIA6QOLucZ8KDHQeAtM01U90V3kPvSw/exec";

const PROGRAMMES = [
  "Master of Science (Clinical Sciences)",
  "Master of Science (Community Medicine)",
  "Master of Science (Human Genetics)",
  "Doctor of Philosophy (Minden)"
  // ðŸ‘‰ boleh tambah sendiri
];

const READY_THRESHOLD = 80; // %

/* ================= LOAD ================= */
async function loadDashboard() {
  const res = await fetch(APPENDIX_API);
  const appendix = await res.json();

  const total = appendix.length;
  const completed = appendix.filter(
    a => (a.STATUS || "").toUpperCase() === "COMPLETE"
  ).length;

  const percent = Math.round((completed / total) * 100);
  const ready = percent >= READY_THRESHOLD;

  const grid = document.getElementById("programmeGrid");
  grid.innerHTML = "";

  PROGRAMMES.forEach(program => {
    const card = document.createElement("div");
    card.className = "card";

    card.innerHTML = `
      <h3>${program}</h3>

      <span class="badge ${ready ? "ready" : "not-ready"}">
        ${ready ? "READY" : "NOT READY"}
      </span>

      <div class="progress">
        <div style="width:${percent}%"></div>
      </div>

      <b>${percent}%</b> COMPLETE  
      <div style="font-size:14px;color:#555">
        ${completed} / ${total} appendix completed
      </div>

      <button onclick="openProgramme('${program}')">
        View Programme Dashboard
      </button>
    `;

    grid.appendChild(card);
  });
}

function openProgramme(program) {
  window.location.href =
    `programme.html?program=${encodeURIComponent(program)}`;
}

loadDashboard();
</script>

</body>
</html>
